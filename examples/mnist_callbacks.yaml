seed: 42
name: &name mnist_callbacks

mlflow:
  experiment_name: *name
  before_run:
    log_params:
      hidden_units: &units 128
    set_tags:
      name: *name
  after_run:
    log_artifacts: $base_path

model: !!python/name:tensorflow.keras.models.Sequential
model_kwds:
  layers: !!python/list
  - !!python/object/apply:tensorflow.keras.layers.Flatten
    kwds: {input_shape: !!python/tuple [28, 28]}
  - !!python/object/apply:tensorflow.keras.layers.Dense
    args: [*units]
    kwds: {activation: relu}
  - !!python/object/apply:tensorflow.keras.layers.Dropout
    args: [0.2]
  - !!python/object/apply:tensorflow.keras.layers.Dense
    args: [10]
data_loader: !!python/name:keras.api._v2.keras.datasets.mnist.load_data

model_checkpoints: !join
- !store
  - base_path
  - !abspathjoin
    - logs
    - *name
- mcp
compile_kwds:
  loss: !!python/object/apply:tensorflow.python.keras.losses.SparseCategoricalCrossentropy
    kwds: {from_logits: true}
  metrics: [accuracy]
  optimizer: adam

fit_kwds:
  epochs: 5
  batch_size: 32
  shuffle: true
  validation_split: 0.1
  callbacks: !include inc/callbacks.yaml
